<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cozy Hub - Task 1</title>
<style>body{margin:0;min-height:100vh;display:grid;place-items:center;background:#050811;color:#eaf6ff;font-family:system-ui,Poppins,sans-serif}
.card{width:min(420px,92vw);padding:22px;border-radius:18px;border:1px solid rgba(0,229,255,.22);background:#070b17cc;text-align:center;box-shadow:0 0 50px rgba(0,229,255,.12)}
.btn{width:100%;padding:14px;border:0;border-radius:14px;background:linear-gradient(90deg,#00e5ff,#00b7ff);font-weight:800;cursor:pointer}
.small{opacity:.85;margin-top:10px;font-size:13px}
</style>
</head>
<body>
<div class="card">
  <h2 style="margin:0;color:#00e5ff">Mission 1</h2>
  <p id="p">Complete mission 1, then click “I’m done”.</p>
  <button class="btn" id="do">Start Mission 1</button>
  <button class="btn" id="done" style="margin-top:10px;background:rgba(255,255,255,.08);color:#eaf6ff;border:1px solid rgba(0,229,255,.18)">I’m done</button>
  <div class="small" id="s"></div>
</div>

<script>
const langRaw=(navigator.language||"en").toLowerCase();
const lang = (langRaw.startsWith("vi")?"vi":langRaw.startsWith("th")?"th":langRaw.startsWith("id")?"id":(langRaw.startsWith("fil")||langRaw.startsWith("ph")||langRaw.startsWith("tl"))?"ph":"en");
const T={
  p:{en:"Complete mission 1, then click “I’m done”.",vi:"Hoàn thành nhiệm vụ 1 rồi bấm “Đã xong”.",th:"ทำภารกิจ 1 ให้เสร็จแล้วกด “เสร็จแล้ว”",id:"Selesaikan misi 1 lalu klik “Selesai”.",ph:"Tapusin ang mission 1 tapos i-click “Done”."},
  do:{en:"Start Mission 1",vi:"Làm nhiệm vụ 1",th:"เริ่มภารกิจ 1",id:"Mulai Misi 1",ph:"Simulan ang Mission 1"},
  done:{en:"I’m done",vi:"Đã xong",th:"เสร็จแล้ว",id:"Selesai",ph:"Done"},
  wait:{en:"Issuing secure token…",vi:"Đang tạo token bảo mật…",th:"กำลังสร้างโทเค็น…",id:"Membuat token…",ph:"Gumagawa ng token…"},
  err:{en:"System error. Try again.",vi:"Lỗi hệ thống. Thử lại.",th:"ระบบผิดพลาด ลองใหม่",id:"Error sistem. Coba lagi.",ph:"System error. Subukan ulit."}
};
document.getElementById("p").textContent=T.p[lang];
document.getElementById("do").textContent=T.do[lang];
document.getElementById("done").textContent=T.done[lang];

document.getElementById("do").onclick=()=> {
  localStorage.setItem("cozy_task1_clicked","1");
  location.href="https://direct-link.net/1457968/wqITOYXxDOMd";
};

document.getElementById("done").onclick=async ()=>{
  document.getElementById("s").textContent=T.wait[lang];
  try{
    const res = await fetch("https://cozyhub-verify1.aovo4504.workers.dev/issue",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ ok:true })
    });
    const data = await res.json();
    if(!data.ok) throw 0;
    localStorage.setItem("cozy_task1","done");
    location.href = "https://aovo4504-bit.github.io/task2/index.html?token="+encodeURIComponent(data.token);
  }catch(e){
    document.getElementById("s").textContent=T.err[lang];
  }
};
</script>
</body>
</html>
