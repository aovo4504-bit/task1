<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mission 1 Check | Cozy Hub</title>
<style>
body{
  background:#050811;
  margin:0;
  font-family:Poppins,sans-serif;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.card{
  background:rgba(10,15,25,0.85);
  padding:30px;
  width:90%;
  max-width:380px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 0 25px #00eaff88;
}
.btn{
  margin-top:20px;
  padding:12px 0;
  width:100%;
  border:none;
  border-radius:10px;
  font-size:17px;
  background:#00eaff;
  color:#001216;
  cursor:pointer;
  font-weight:700;
}
.hidden{display:none;}
</style>
</head>
<body>

<div class="card">
  <h2>Mission 1 Verification</h2>
  <p id="msg">Checking mission status...</p>
  <button id="btnNext" class="btn hidden">Continue to Mission 2</button>
</div>

<script>
const VERIFY1 = "https://cozyhub-verify1.aovo4504.workers.dev/";
const NV2 = "https://link-target.net/1457968/nP7uWHQKwUUq";

async function run(){
  const params = new URLSearchParams(location.search);
  const token = params.get("token");

  const msg = document.getElementById("msg");
  const btn = document.getElementById("btnNext");

  if(!token){
    msg.textContent = "You must complete Mission 1 before accessing this page.";
    return;
  }

  try{
    const res = await fetch(VERIFY1,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ token })
    });
    const data = await res.json();

    if(!data.ok){
      msg.textContent = "Mission 1 NOT verified. Please finish the task properly.";
      return;
    }

    // success
    localStorage.setItem("cozy_task1","done");
    msg.textContent = "Mission 1 Completed âœ“";
    btn.classList.remove("hidden");

  }catch(e){
    msg.textContent="System error. Try again.";
  }
}

document.getElementById("btnNext").onclick = ()=>location.href = NV2;

run();
</script>

</body>
</html>
